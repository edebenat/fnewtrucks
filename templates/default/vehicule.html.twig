{% extends 'base.html.twig' %}

{% block title %}F New Trucks - Nos véhicules en stock{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href={{asset("bundles/slick/slick.css")}}>
    <link rel="stylesheet" href={{asset("bundles/slick/slick-theme.css")}}>
{% endblock %}

{% block javascripts %}
    <script src={{ asset('bundles/slick/slick.min.js') }}></script>
{% endblock %}

{% block body %}
<section class="vehicleOne">
    <div class="vehicleOneImages">
            <div class="slider-for">
                {% for image in vehicle.images %}
                    <img src={{ asset(image) }} alt="{{vehicle.model}}">
                {% endfor %}
            </div>
            <div class="slider-nav">
                {% for image in vehicle.images %}
                    <img src={{ asset(image) }} alt="{{vehicle.model}}">
                {% endfor %}
            </div>
{#
        {% for key, image in vehicle.images %}
            <div class="vehicleOneImage" onclick="openGallery({{key}})">
                <img src={{ asset(image) }} alt="{{ vehicle.model }}">
            </div>
        {% endfor %}
#}
    </div>
    <div class="vehicleOneDetails">
        <div class="vehicleOneTitle">
            <h1>{{ vehicle.model }}</h1>
            <p>{{ vehicle.type }}</p>
        </div>
        <div class="vehicleOneCaracts">
            {% if vehicle.mileageFromOdometer|length %}
                {% set new = false %}
            {% else %}
                {% set new = true %}
            {% endif %}
            <hr>
            <div class="row">
                {% if new == false %}
                    <div>{{ vehicle.state }}</div>
                    <div>{{ vehicle.mileageFromOdometer }}</div>
                    <div>{{ vehicle.enginePower }}</div>
                {% else %}
                    <div>{{ vehicle.state }}</div>
                    <div>{{ vehicle.enginePower }}</div>
                    <div>{{ vehicle.gears }}</div>
                {% endif %}
            </div>
            <hr>
            <div class="row">
                {% if new == false %}
                    <div>{{ vehicle.gears }}</div>
                    <div>{{ vehicle.carac1 }}</div>
                    <div>{{ vehicle.carac2 }}</div>
                {% else %}
                    <div>{{ vehicle.carac1 }}</div>
                    <div>{{ vehicle.carac2 }}</div>
                    <div>{{ vehicle.carac3 }}</div>
                {% endif %}
            </div>
            <hr>
            <div class="row">
                {% if new == false %}
                    <div>{{ vehicle.carac3 }}</div>
                    <div>{{ vehicle.carac4 }}</div>
                {% else %}
                    <div>{{ vehicle.carac4 }}</div>
                {% endif %}
            </div>
            <hr>
        </div>
        <div class="vehicleOneEquipments">
            <div class="bold">Equipements :</div>
            <div class="light">{{ vehicle.equipments | raw }}</div>
        </div>
        <div class="btn btnOrange" onclick="openForm({{vehicle.id}})"><span>Je suis intéressé</span><img src={{ asset('images/orange-arrow.png') }}></div>
    </div>
</section>
<div id="vehicleGallery">
    <div class="slick">
        {% for image in vehicle.images %}
            <img src={{ asset(image) }}>
        {% endfor %}
    </div>
</div>
<div class="vehiclesForm" id="vehiclesForm">
    {{ form_start(form, {'attr': {'id': 'contactForm'}}) }}
        <h2>Nous contacter</h2>
        {{ form_row(form.firstname) }}
        {{ form_row(form.lastname) }}
        {{ form_row(form.email) }}
        {{ form_row(form.tel) }}
        <div id="contact_submit">
            <div class="btn btnOrange" onclick="submitForm();"><span>Envoyer</span><img src={{ asset('images/orange-arrow.png') }}></div>
        </div>
        <div id="contact_cancel">
            <div class="btn btnTransparent"><span>Annuler</span><img src={{ asset('images/orange-arrow.png') }}></div>
        </div>
        <div id="vehiclesFormError">Vous devez remplir tous les champs</div>
    {{ form_end(form) }}
</div>
<script>
    $(document).ready(function(){
        $('.slider-for').slick({
            slidesToShow: 1,
            slidesToScroll: 1,
            adaptiveHeight: true,
            dots: true,
            asNavFor: '.slider-nav'
        });
        $('.slider-nav').slick({
            slidesToShow: 3,
            slidesToScroll: 1,
            asNavFor: '.slider-for',
            centerMode: true,
            focusOnSelect: true
        });
    });
</script>
<script>
    function openGallery(key){
        $('.slick').slick('slickGoTo', key);
        $('#vehicleGallery').addClass('show');
    }
    $('#vehicleGallery').click(function(){
        $('#vehicleGallery').removeClass('show');
    }).children().click(function(e){
        return false;
    });

    function closeImg(div){
        div.removeClass('show');
    }
    function openImg(id, key){
        div = '#img' + id + '-' + key;
        $(div).addClass('show');
    }
    function openForm(id){
        $('#contact_vehicle').val(id);
        $('#vehiclesForm').addClass('show');
    }
    $('#vehiclesForm').click(function(){
        clearForm();
    }).children().click(function(e){
        return false;
    });
    $('#contact_cancel').click(function(){
        clearForm();
    });
    function clearForm(){
        $('#vehiclesForm').removeClass('show');
        $('#vehiclesForm input').val('');
    }
    function submitForm(){
        if ($('#contact_firstname').val() != '' && $('#contact_lastname').val() != '' && $('#contact_email').val() != '' && $('#contact_tel').val() != ''){
            $('#contactForm').submit();
        }
        else{
            $('#vehiclesFormError').addClass('show');
            setTimeout(function(){
                $('#vehiclesFormError').removeClass('show');
            }, 3000);
        }
    }
</script>

{% endblock %}
